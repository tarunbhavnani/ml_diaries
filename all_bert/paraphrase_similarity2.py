# -*- coding: utf-8 -*-
"""
Created on Fri Mar 26 11:00:09 2021

@author: ELECTROBOT
"""

roger= """
Roger Federer (German pronunciation: [ˈrɔdʒər ˈfeːdərər]; born 8 August 1981) is a Swiss professional tennis player. He is ranked No. 6 in the world by the Association of Tennis Professionals (ATP). He has won 20 Grand Slam men's singles titles, an all-time record shared with Rafael Nadal. Federer has been world No. 1 in the ATP rankings a total of 310 weeks – including a record 237 consecutive weeks – and has finished as the year-end No. 1 five times. Federer has won 103 ATP singles titles, the second-most of all-time behind Jimmy Connors and including a record six ATP Finals.

Federer has played in an era where he dominated men's tennis together with Rafael Nadal and Novak Djokovic, who have been collectively referred to as the Big Three and are widely considered three of the greatest male tennis players of all-time.[c] A Wimbledon junior champion in 1998, Federer won his first Grand Slam singles title at Wimbledon in 2003 at age 21. In 2004, he established himself as the best player in men's tennis by winning three out of four major singles titles and the ATP Finals,[d] a feat he repeated in 2006 and 2007. From 2005 to 2010, Federer made 18 out of 19 major singles finals. During this span, he won his fifth consecutive titles at both Wimbledon and the US Open. He completed the career Grand Slam at the 2009 French Open after three previous runner-ups to Nadal, his main rival up until 2010. At age 27, he also surpassed Pete Sampras's then-record of 14 Grand Slam men's singles titles at Wimbledon in 2009.

Although Federer remained in the top 3 through most of the 2010s, the success of Djokovic and Nadal in particular ended his dominance over grass and hard courts. From mid-2010 through the end of 2016, he only won one major title. During this period, Federer and Stan Wawrinka led the Switzerland Davis Cup team to their first title in 2014, adding to the gold medal they won together in doubles at the 2008 Beijing Olympics. Federer also has a silver medal in singles from the 2012 London Olympics, where he finished runner-up to Andy Murray. After taking half a year off in late 2016 to recover from knee surgery, Federer had a renaissance at the majors. He won three more Grand Slam singles titles over the next two years, including the 2017 Australian Open over Nadal and a men's singles record eighth Wimbledon title in 2017 later that year. He also became the oldest ATP world No. 1 in 2018 at age 36.

A versatile all-court player, Federer's perceived effortlessness has made him highly popular among tennis fans. Originally lacking self-control as a junior, Federer transformed his on-court demeanor to become well-liked for his general graciousness, winning the Stefan Edberg Sportsmanship Award 13 times. He has also won the Laureus World Sportsman of the Year award a record five times. Outside of competing, he played an instrumental role in the creation of the Laver Cup team competition. Federer is also an active philanthropist. He established the Roger Federer Foundation, which targets impoverished children in southern Africa, and has raised funds in part through the Match for Africa exhibition series. Federer is routinely one of the highest-paid athletes in any sport, and ranked first among all athletes with $100 million in endorsement income in 2020.



Federer was born in Basel, Switzerland.[3] His Swiss father, Robert Federer, is from Berneck in the Canton of St. Gallen, and his Afrikaner mother, Lynette Federer (née Durand), is from Kempton Park, Gauteng, in South Africa. Federer has one sibling, his older sister, Diana,[4] who is the mother of a set of twins.[5] Since his mother is South African, he holds both Swiss and South African citizenship.[6] He grew up in nearby Birsfelden, Riehen, and then Münchenstein, close to the French and German borders, and he speaks Swiss German, Standard German, English, and French fluently, as well as functional Italian and Swedish; Swiss German is his native language.[3][7][8][9] Federer served as a ball boy at his hometown Basel tournament, the Swiss Indoors, in 1992 and 1993.[7][10]

Like all male Swiss citizens, Federer was subject to compulsory military service in the Swiss Armed Forces. However, in 2003 he was ruled "unsuitable" and was subsequently not required to fulfill his military obligation.[11] Instead, he served in the civil protection force and was required to pay 3% of his taxable income as an alternative.[12] He grew up supporting FC Basel and the Swiss national football team.[13] Federer also credits his hand-eye coordination to the wide range of sports he played as a child, including badminton and basketball.[14]


Federer is married to former Women's Tennis Association player Miroslava Federer (née Vavrinec), whom he met while they were both competing for Switzerland at the 2000 Sydney Olympics. Usually called Mirka, she retired from the tour in 2002 because of a foot injury.[15] They were married at Wenkenhof Villa in Riehen near Basel on 11 April 2009, surrounded by a small group of close friends and family.[16] In 2009, Mirka gave birth to identical twin girls.[17] The Federers had another pair of identical twins in 2014, this time boys.[18][19]

Tennis career
1993–1998: Junior years
Main article: Roger Federer junior years
Federer's main accomplishments as a junior player came at Wimbledon in 1998, where he won both the boys' singles final over Irakli Labadze,[20] and in doubles teamed with Olivier Rochus, defeating the team of Michaël Llodra and Andy Ram.[21] In addition, Federer reached the US Open Junior final in 1998, losing to David Nalbandian. He won four ITF junior singles tournaments in his career, including the prestigious Orange Bowl, where he defeated Guillermo Coria in the final.[22] He ended 1998 with the No. 1 junior world ranking, was awarded ITF junior World Champion, and entered his first tournament as a professional during 1998 in Gstaad, where he lost to Lucas Arnold Ker in the first round.[23]

1998–2002: Early professional career
Main article: Roger Federer's early career
Federer entered the top 100 ranking for the first time on 20 September 1999 and started at the 1999 Marseille Open defeating the reigning champion of the 1998 French Open, Spaniard Carlos Moyá. His first final came at the Marseille Open in 2000, where he lost to fellow Swiss Marc Rosset.[24] Federer won the 2001 Hopman Cup representing Switzerland, along with world No. 1 Martina Hingis.[25][26][27] The duo defeated the American pair of Monica Seles and Jan-Michael Gambill in the finals. Federer later said that his experience with Hingis "definitely helped me to become the player I am today."[28]

Federer's first singles win was at the 2001 Milan Indoor tournament, where he defeated Julien Boutter in the final.[24][29] Although he won his first title already in 1999 on the Challenger tour, winning the doubles event in Segovia, Spain with Dutchman Sander Groen, the final was played on Federer's 18th birthday. In 2001, Federer made his first Grand Slam quarterfinal at the French Open, losing to former world No. 2 and eventual finalist Alex Corretja. His run to the French quarterfinals launched him into the top 15 for the first time in his career.[30][31]

His international breakthrough came at the 2001 Wimbledon Championships, where the 19-year-old Federer faced the four-time defending champion and all-time Grand Slam leader Pete Sampras. Federer beat the No. 1 seed in a five-set match to reach the quarterfinals.[32] In the quarters he faced Englishman Tim Henman, eventually losing in a fourth-set tiebreaker.[33]

The first final he reached at the Masters level came at the 2002 Miami Masters event, where he lost to former and future No. 1 Andre Agassi on hard court.[34][35] Federer won his first Master Series event at the 2002 Hamburg Masters on clay, over Marat Safin; the victory put him in top 10 for the first time.[34][36] Federer made 10 singles finals between 1998 and 2002, of which he won four and lost six.[24][34][37][38][30] He also made six finals in doubles. He finished 2001 with an ATP ranking of No. 13, and 2002 was the first year he was ranked within the top 10, finishing at No. 6.[36]
"""

import re
alphabets= "([A-Za-z])"
prefixes = "(Mr|St|Mrs|Ms|Dr|No)[.]"
suffixes = "(Inc|Ltd|Jr|Sr|Co)"
starters = "(Mr|Mrs|Ms|Dr|He\s|She\s|It\s|They\s|Their\s|Our\s|We\s|But\s|However\s|That\s|This\s|Wherever)"
acronyms = "([A-Z][.][A-Z][.](?:[A-Z][.])?)"
websites = "[.](com|net|org|io|gov|co|in)"

def split_into_sentences(text):
    text = " " + text + "  "
    text = text.replace("\n"," ")
    text= re.sub(r'(?<=\[).+?(?=\])', "", text) # remove everything inside square brackets
    text= re.sub(r'(?<=\().+?(?=\))', "", text) # remove everything inside  brackets
    text = re.sub(prefixes,"\\1<prd>",text)
    text = re.sub(websites,"<prd>\\1",text)
    if "i.e." in text: text = text.replace("i.e.","i<prd>e<prd>")
    if "e.g" in text: text = text.replace("e.g","e<prd>g")
    if "www." in text: text = text.replace("www.","www<prd>")
    text = re.sub("\s" + alphabets + "[.] "," \\1<prd> ",text)
    text = re.sub(acronyms+" "+starters,"\\1<stop> \\2",text)
    text = re.sub(alphabets + "[.]" + alphabets + "[.]" + alphabets + "[.]","\\1<prd>\\2<prd>\\3<prd>",text)
    text = re.sub(alphabets + "[.]" + alphabets + "[.]","\\1<prd>\\2<prd>",text)
    text = re.sub(" "+suffixes+"[.] "+starters," \\1<stop> \\2",text)
    text = re.sub(" "+suffixes+"[.]"," \\1<prd>",text)
    text = re.sub(" " + alphabets + "[.]"," \\1<prd>",text)
    if "”" in text: text = text.replace(".”","”.")
    if "\"" in text: text = text.replace(".\"","\".")
    if "!" in text: text = text.replace("!\"","\"!")
    if "?" in text: text = text.replace("?\"","\"?")
    text = text.replace(".",".<stop>")
    text = text.replace("?","?<stop>")
    text = text.replace("!","!<stop>")
    text = text.replace("<prd>",".")
    sentences = text.split("<stop>")
    #sentences = sentences[:-1]
    sentences = [s.strip() for s in sentences]
    return sentences




all_sents= split_into_sentences(roger)

all_sents= [re.sub(r'[^a-z0-9\.\(\) ]', " ",i.lower()) for i in all_sents]
all_sents= [re.sub(r'\s+', " ",i.strip()) for i in all_sents]




embeddings= model.encode(all_sents, convert_to_tensor=True)

question= "federer is married to whome"
question_embedding= model.encode([question], convert_to_tensor=True)

scores= util.pytorch_cos_sim(question_embedding, embeddings)


req=torch.argmax(scores).detach().cpu().numpy().reshape(-1)[0]


#for all

dict_scores={i:j for i,j in enumerate(scores.detach().cpu().numpy()[0])}
dict_scores={k: v for k, v in sorted(dict_scores.items(), key=lambda item: item[1], reverse= True)}




[all_sents[i] for i in dict_scores]














